<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark">
<meta property="og:title" content="Architecture" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="notes/architecture.html" />
  
<meta property="og:description" content="Motivation: Existing big data practice usually adopts distributed databases or file systems as the intermediate storage to share immutable distributed data between heterogeneous computation systems..." />
  <link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Internals of Objects" href="objects.html" /><link rel="prev" title="Installation" href="install.html" />

    <link rel="shortcut icon" href="../_static/vineyard.ico"/><meta name="generator" content="sphinx-5.0.2, furo 2022.06.21"/>
        <title>Architecture - Vineyard</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/brands.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/v4-shims.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/panels.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
  <script>
    document.body.dataset.theme = "light";
  </script>


<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Vineyard</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/vineyard-logo-h.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../user-guide.html">User Guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="objects.html">Internals of Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-accessing.html">Shared Data Accessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="streams.html">Streams in Vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="io-drivers.html">I/O Drivers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/distributed-learning.html">Distributed Learning with Vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/adding-custom-datatypes-cpp.html">Adding Custom Data Types in C++</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Integrations</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../integrations.html">Integrations</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="dask.html">Dask on Vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="ml.html">Machine Learning with Vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="airflow.html">Airflow on Vineyard</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deployment</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../deployment.html">Deployment</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="deploy-locally.html">Deploying on Linux/MacOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy-docker.html">Deploying using Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy-kubernetes.html">Deploying on Kubernetes</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api-reference.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="python-api.html">Python API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpp-api.html">C++ API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="ctl.html">Vineyard Cli</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../community.html">Join the Community</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contributing to vineyard</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/v6d-io/v6d/edit/main/docs/notes/architecture.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="architecture">
<h1>Architecture<a class="headerlink" href="#architecture" title="Permalink to this heading">#</a></h1>
<div class="section" id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this heading">#</a></h2>
<p>Existing big data practice usually adopts distributed databases or file systems as the
intermediate storage to share <strong>immutable</strong> distributed data between heterogeneous
computation systems that are involved in a big data task. This
brings two significant overheads:</p>
<ol class="arabic simple">
<li><p>The structural data is transformed from/to the external data storage format (e.g.,
tables in relational databases, files in HDFS) back and forth in the beginning/end
of each computation step, meanwhile, the structure and operations of the data are
dismissed.</p></li>
<li><p>Saving/Loading the data to/from the external storage requires lots of memory-copies
and disk-IO costs, which becomes the bottleneck of the entire process in more and
more cases as the efficiency of the computation systems are growing rapidly these years.</p></li>
</ol>
<p>In addition, the lack of managing the data uniformly through the big data task obstructs
the application of modern techniques such as data monitoring, data-aware
optimization, and fault-tolerance, thus, further decreases the productive efficiency.</p>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>To address this issue, vineyard provides:</p>
<ol class="arabic">
<li><p><strong>In-memory</strong> distributed data sharing in a <strong>zero-copy</strong> fashion to avoid
introducing extra I/O costs by exploiting a shared memory manager derived from plasma.</p>
<p>In general, vineyard servers are launched as daemons in every machine of the underlying
cluster to make up a <strong>vineyard cluster</strong>, and each vineyard instance will allocate
a shared memory pool to store the corresponding partition of the distributed data,
and the meta data of the distributed data will be shared across the vineyard cluster
via the backend key-value store, e.g., etcd or zookeeper.</p>
<div class="figure align-default" id="id3">
<img alt="Distributed data sharing in vineyard" src="../_images/vineyard_deployment.jpg" />
<p class="caption"><span class="caption-text">Distributed data sharing in vineyard</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</div>
<p>For example, a distributed tensor is stored in the vineyard cluster as illustrated
above. Each partition is stored in the corresponding vineyard instance, while the
meta data, e.g., the shape of the tensor is stored in the backend key-value server
of vineyard, i.e., the etcd server.</p>
<p>To reuse the distributed tensor in parallel processing, each process will first
establish a vineyard client that is connected to the corresponding vineyard
instance on the same machine, and then get the meta data of the distributed tensor.
Finally based on the meta data, each process can get the corresponding partitions
of the distributed tensor from the vineyard instance via memory mapping in a
<strong>zero-copy</strong> fashion, and start to use the data for computation.</p>
</li>
<li><p>Built-in <strong>out-of-the-box high-level</strong> abstraction to share the distributed data with
complex structures (e.g., distributed graphs)  with nearly zero extra development
cost, while the transformation costs are eliminated.</p>
<p>For example, a distributed graph is composed of fragments that are stored distributedly
over the vineyard cluster, and each fragment consists of vertices, edges, data on
vertices, data on edges, indices (e.g., the CSR indexing), vertex maps and so on.</p>
<p>Unlike the external storage approach where fragments are transformed into adjacent
matrix to fit into a table schema in the database, vineyard stores the fragment
with the structure, so that when we use the graph, the indices can be directly reused
to facilitate the graph traversal. Furthermore, the high-level abstracted graph
traversal operations are built-in with the vineyard distributed graph, as a result,
nearly zero extra development are required to reuse the data.</p>
</li>
</ol>
</div>
<div class="section" id="architecture-of-vineyard">
<span id="id1"></span><h2>Architecture of vineyard<a class="headerlink" href="#architecture-of-vineyard" title="Permalink to this heading">#</a></h2>
<div class="figure align-default" id="id4">
<img alt="Architecture of vineyard" src="../_images/vineyard_arch.jpg" />
<p class="caption"><span class="caption-text">Architecture of vineyard</span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</div>
<p>The figure above demonstrates the architecture of vineyard.</p>
<div class="section" id="server-side">
<h3>Server side<a class="headerlink" href="#server-side" title="Permalink to this heading">#</a></h3>
<p>On the server (daemon) side (i.e., the aforementioned vineyard instance), there are
three major components:</p>
<ol class="arabic">
<li><p>The <strong>shared memory</strong> is the memory space in vineyard that shares with vineyard
clients via the UNIX domain socket by memory mapping.</p>
<p>As we mentioned before, the partitions of the distributed data are living in the
shared memory of the corresponding vineyard instance in the cluster.</p>
</li>
<li><p>The <strong>metadata manager</strong> provides management for the metadata of the data stored
in vineyard.</p>
<p>The metadata manager keeps the metadata (structures, layouts and properties) of
the data to provide high-level abstractions (e.g., graphs, tensors, dataframes).The metadata managers in a vineyard cluster communicate with each other through
the backend key-value store,  e.g., etcd server, to keep the consistency of the
distributed data stored in vineyard.</p>
</li>
<li><p>The <strong>IPC/RPC servers</strong> handle the IPC/RPC connections respectively from vineyard
clients for data sharing.</p>
<p>In particular, the client can get the metadata of the data stored in vineyard through
both IPC and RPC connections. But to get the data partition, the client has to connect
to the vineyard instance through UNIX domain socket, this is because, the data
sharing is via the system call of memory mapping, thus requires the client to stay
in the same machine of the vineyard instance.</p>
</li>
</ol>
</div>
<div class="section" id="client-side">
<span id="id2"></span><h3>Client side<a class="headerlink" href="#client-side" title="Permalink to this heading">#</a></h3>
<p>On the client side, the core components is the <strong>vineyard client</strong>. The client side
consists both the low-level APIs for accessing the vineyard instances in a delicate
fashion as well as high-level APIs for data structure sharing and manipulation and
routines reusing (e.g., I/O drivers). More specifically,</p>
<ol class="arabic">
<li><p>The <strong>IPC client</strong> communicates with <em>locally</em> vineyardd instances by connecting
to the UNIX domain socket.</p>
<p>The IPC client is used to establish a IPC connection between vineyard server and
the client, making memory-sharing (by <code class="code docutils literal notranslate"><span class="pre">mmap</span></code> and transferring the file descriptor)
possible between the vineyard server and the computing engines.</p>
</li>
<li><p>The <strong>RPC client</strong> communicates with <em>remote</em> vineyardd instances by connecting
to the TCP port that the vineyard daemon is bind to.</p>
<p>Unlike the IPC client, the RPC doesn’t allow the memory-sharing between processes
but is useful for retrieving the metadata of objects in the vineyard cluster.</p>
</li>
<li><p>The <strong>builders and resolvers</strong> for out-of-the-box high-level data abstractions
provide a convenient way for the applications to consume objects in vineyard and
produces result objects into vineyard.</p>
<p>The builders and resolvers adopt an extensible design where the users can register
their own builders and resolvers for their newly defined data types, as well as
new builders and resolvers that building the ad-hoc engine-specific data structures
as vineyard objects and wrapping vineyard objects as engine-specific data types
at a low cost.</p>
<p>The builders, resolvers, as well as the registry are part of the language-specific
SDKs of vineyard. Currently Python and C++ are officially supported and the Rust
and Go SDKs are under heavily development.</p>
</li>
<li><p>The <strong>plugable drivers</strong> assign specific functionalities to certain types of data
in vineyard.</p>
<p>In particular, I/O drivers sync with external storages such as databases and file
systems to read data into and write data from vineyard, while partition and
re-partition drivers reorganize the distributed graphs stored in vineyard to
balance the workload.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The drivers usually employ the low-level APIs for delicate operations.</p>
</div>
</li>
<li><p><strong>Object migration</strong> is the mechanism that implemented in the client side to
migrate objects between vineyardd instances in a cluster. The object migration
is usually needed when the computing engines cannot be scheduled to co-located
with the data that the jobs needed is placed.</p>
<p>Object migration is implemented in the client side as a process pair where the
sender and receiver are both connected to (different) vineyardd instances and
communicate with each other using TPC to move objects between vineyard instances.
We don’t put the object migration to the server side to decouple the functionalities
and allows users to registry a more efficient object migration implemented on
their own deployment infrastructures, e.g., leveraging RDMA and other high-performance
network technologies.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="core-features">
<h2>Core features<a class="headerlink" href="#core-features" title="Permalink to this heading">#</a></h2>
<div class="section" id="distributed-data-sharing-in-big-data-tasks">
<h3>Distributed data sharing in big data tasks<a class="headerlink" href="#distributed-data-sharing-in-big-data-tasks" title="Permalink to this heading">#</a></h3>
<p>By examining the practice of big data tasks such as numeric computing, machine learning
and graph analysis carefully, we summarize that the data involved has four properties:</p>
<ul class="simple">
<li><p>Distributed and each partitioned fragment usually fits into memory;</p></li>
<li><p>Immutable, i.e., never modified after creation;</p></li>
<li><p>With complex structure, e.g., graph in CSR format;</p></li>
<li><p>Required to share between different computation systems and programming languages.</p></li>
</ul>
<p>Thus vineyard is designed accordingly with:</p>
<ul class="simple">
<li><p>Composable design on vineyard objects;</p></li>
<li><p>Immutable zero-cost in-memory data sharing via memory mapping;</p></li>
<li><p>Out-of-box high-level data abstraction for complex data structures;</p></li>
<li><p>Extensible design on builder/resolver/driver for flexible crossing-system and
crossing-language data sharing.</p></li>
</ul>
<p>In general, the design choices of vineyard are fully determined on coping
the difficulties in handling large-scale distributed data in practice.</p>
</div>
<div class="section" id="out-of-box-high-level-data-abstraction">
<h3>Out-of-box high-level data abstraction<a class="headerlink" href="#out-of-box-high-level-data-abstraction" title="Permalink to this heading">#</a></h3>
<p>Vineyard objects are stored with structures, and high-level abstractions.
For instance, a graph with CSR format in vineyard stores the index as long as
the vertices and edges, so that operations like edge iteration based on the
index can be provided. Thus, users don’t have to implement the index-building
function and edge iterators by themselves, which is usually required in the
existing big data practice.</p>
</div>
<div class="section" id="zero-cost-in-memory-data-sharing">
<h3>Zero-cost in-memory data sharing<a class="headerlink" href="#zero-cost-in-memory-data-sharing" title="Permalink to this heading">#</a></h3>
<p>Vineyard provides zero-cost data sharing by memory-mapping, since data objects
in vineyard are immutable. When the object is created, we allocate blobs in
vineyard to store the data payload, on the other hand, when getting the object,
we map the blob from the vineyard instance into the application process with
inter-process memory mapping approaches, so that no memory copy is involved
in sharing the data payload.</p>
</div>
<div class="section" id="convenient-data-integration">
<h3>Convenient data integration<a class="headerlink" href="#convenient-data-integration" title="Permalink to this heading">#</a></h3>
<p>The extensive design on builder/resolver/driver allows convenient extension
of existing vineyard objects to different programming languages. Moreover,
with codegen tools in vineyard, makes it possible for users to transplant their
data structures into vineyard with only a few annotations.</p>
</div>
<div class="section" id="data-orchestration-in-a-python-notebook">
<h3>Data orchestration in a python notebook<a class="headerlink" href="#data-orchestration-in-a-python-notebook" title="Permalink to this heading">#</a></h3>
<p>Using vineyard as the common data orchestration engine through the end-to-end
big data processing, users can hold large-scale distributed data as variables
of vineyard objects in python. Thus, as long as the computation modules
involved provides python API, users can write down the entire processing
pipeline in a python notebook. By running the python script, users can
manage trillions of data and different computation systems in the background
distributedly across the cluster.</p>
</div>
</div>
<div class="section" id="non-goals-and-limitations">
<h2>Non-goals and limitations<a class="headerlink" href="#non-goals-and-limitations" title="Permalink to this heading">#</a></h2>
<div class="section" id="not-for-mutable-objects">
<h3><em>NOT</em> for mutable objects<a class="headerlink" href="#not-for-mutable-objects" title="Permalink to this heading">#</a></h3>
<p>Once a vineyard object is created and sealed in the vineyard instance, it
becomes immutable and can NOT be modified anymore. Thus vineyard is not
suitable to be utilized as a data cache to store mutable data that changes
rapidly along the processing pipeline.</p>
</div>
<div class="section" id="not-for-instant-remote-data-partition-accessing">
<h3><em>NOT</em> for instant remote data partition accessing<a class="headerlink" href="#not-for-instant-remote-data-partition-accessing" title="Permalink to this heading">#</a></h3>
<p>The partitions of a distributed data are stored distributedly in corresponding
vineyard instances of the cluster. Only the client on the same machine can access
the data partition. In case to access a remote partition, data migration APIs of
vineyard can be invoked to trigger migration process, but not for instant accessing.</p>
</div>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="objects.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Internals of Objects</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="install.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Installation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2019-2022, The Vineyard Authors
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa fa-solid fa-github fa-2x" href="https://github.com/v6d-io/v6d" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Architecture</a><ul>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#architecture-of-vineyard">Architecture of vineyard</a><ul>
<li><a class="reference internal" href="#server-side">Server side</a></li>
<li><a class="reference internal" href="#client-side">Client side</a></li>
</ul>
</li>
<li><a class="reference internal" href="#core-features">Core features</a><ul>
<li><a class="reference internal" href="#distributed-data-sharing-in-big-data-tasks">Distributed data sharing in big data tasks</a></li>
<li><a class="reference internal" href="#out-of-box-high-level-data-abstraction">Out-of-box high-level data abstraction</a></li>
<li><a class="reference internal" href="#zero-cost-in-memory-data-sharing">Zero-cost in-memory data sharing</a></li>
<li><a class="reference internal" href="#convenient-data-integration">Convenient data integration</a></li>
<li><a class="reference internal" href="#data-orchestration-in-a-python-notebook">Data orchestration in a python notebook</a></li>
</ul>
</li>
<li><a class="reference internal" href="#non-goals-and-limitations">Non-goals and limitations</a><ul>
<li><a class="reference internal" href="#not-for-mutable-objects"><em>NOT</em> for mutable objects</a></li>
<li><a class="reference internal" href="#not-for-instant-remote-data-partition-accessing"><em>NOT</em> for instant remote data partition accessing</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>